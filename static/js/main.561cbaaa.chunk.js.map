{"version":3,"sources":["util/songParser.js","util/composeMidiFile.js","util/playMidi.js","samples/SoundFonts.js","components/Fakebook.jsx","util/withSynth.jsx","components/Box.jsx","components/ThreeDCanvas.jsx","components/MidiIn.jsx","components/MidiOut.jsx","components/Code.jsx","util/withMidi.jsx","Routes.jsx","App.jsx","serviceWorker.js","index.js"],"names":["parseSong","_ref","chords","octave","loop","measures","repeat","join","split","parsedChords","parseChords","appendProgressionDetails","map","measure","filter","chord","length","notes","tonal","note","index","concat","spreadOctave","duration","composeMidiFile","tempo","bassLine","arguments","undefined","track","MidiWriter","Track","bassTrack","NoteEvent","pitch","slice","Infinity","event","addEvent","forEach","generateBassLine","setTempo","Writer","dataUri","getRandomNote","weightedNotes","distributeNoteProbability","reverse","w2","w3","Math","floor","random","addRandomNoteToTrack","charAt","Array","fill","Soundfont","require","playMidi","Object","asyncToGenerator","regenerator_default","a","mark","_callee","instrument","ac","wrap","_context","prev","next","AudioContext","then","Player","MidiPlayer","time","currentTime","console","log","name","play","noteName","gain","loadDataUri","error","alert","stop","_x","_x2","apply","this","playMidiThroughOutput","_ref2","_callee2","output","_context2","playNote","stopNote","_x3","_x4","soundFonts","Space","styled","div","_templateObject","Text","text","_templateObject2","Options","_templateObject3","JazzText","textarea","_templateObject4","props","_useState","useState","_useState2","slicedToArray","setChords","_useState3","_useState4","_useState5","_useState6","setLoop","_useState7","_useState8","bass","setBass","_useState9","_useState10","file","setFile","_useState11","_useState12","setInstrument","react_default","createElement","style","width","height","alignItems","paddingTop","onSubmit","e","allChords","preventDefault","flatten","midiDataUri","handleSubmit","value","onChange","target","type","font","href","_templateObject5","tremolo","Tone","Tremolo","start","withSynth","Cmp","synth","PolySynth","oscillator","modulationType","modulationIndex","harmonicity","envelope","attack","decay","sustain","release","chain","Master","fmSynth","FMSynth","toMaster","assign","children","Box","mesh","useRef","hovered","setHover","active","setActive","activeNote","setActiveNote","cutoffValue","setCutoffValue","midiIn","addListener","useEffect","set","detune","removeListener","useFrame","current","rotation","x","y","includes","activationNotes","position","z","rotationY","ref","scale","onClick","ceil","noteFromRotation","triggerAttackRelease","midiOut","onPointerOver","onPointerOut","attach","args","color","SynthBox","ThreeDCanvas","web","SmallCanvas","MidiIn","display","flexDirection","midiIns","justifyContent","input","_midiInput","id","setMidiInId","ThreeDCanvas_ThreeDCanvas","noteEvent","MidiText","MidiOut_templateObject","MidiOut_templateObject2","MidiOut_templateObject3","MidiOut_templateObject4","MidiOut","noteBoxes","midiOuts","_midiOutput","setMidiOutId","_unused","MidiOut_Options","MidiOut_Text","MidiOut_Space","i","Box_Box","key","Code","CodeTitle","CodeSnippet","ThreeDCanvas_SmallCanvas","p","Code_templateObject","Code_templateObject2","withMidi","compose","midiOutId","setMidiOut","setMidiIn","midiInId","setMidiOuts","_useState13","_useState14","setMidiIns","WebMidi","enable","inputs","outputs","getInputById","getOutputById","NavItem","Routes_templateObject","SideNav","Routes_templateObject2","react_router_dom","basename","to","react_router","path","components_Fakebook","MidiIn_MidiIn","components_MidiOut","Code_Code","component","Fakebook","App","className","src_Routes","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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C,IAAWD,OAAO,SAAArC,GACjCyC,QAAQC,IAAIgB,GACZ,IAAMnB,EAAOT,EAAGU,YAChBC,QAAQC,IAAI1C,GACG,YAAfA,EAAM2C,MAAsBe,EACxBA,EAAOE,SAAS5D,EAAM6C,SAAU,MAAO,CAAEN,UACzCmB,EAAOG,SAAS7D,EAAM6C,SAAU,MAAO,CAAEN,KAAM,SAC/CE,QAAQC,IAAI1C,MAEb+C,YAAYzC,GACnB+B,EAAOO,OACT,MAAOI,GACLC,MAAM,sDAhBuB,wBAAAU,EAAAT,SAAAO,MAAH,gBAAAK,EAAAC,GAAA,OAAAP,EAAAH,MAAAC,KAAAhE,YAAA,UC3BrB0E,EAAa,CACxB,YACA,gBACA,uBACA,wBACA,wBACA,QACA,WACA,WACA,UACA,QACA,eACA,UACA,aACA,eACA,gBACA,eACA,wBACA,UACA,QACA,aACA,eACA,WACA,WACA,aACA,oBACA,gBACA,WACA,uBACA,qBACA,uBACA,wBACA,uBACA,wBACA,mBACA,mBACA,eACA,SACA,QACA,cACA,gBACA,YACA,kBACA,eACA,kBACA,kBACA,eACA,cACA,aACA,eACA,oBACA,mBACA,UACA,YACA,cACA,aACA,kBACA,UACA,OACA,gBACA,kBACA,kBACA,eACA,iBACA,eACA,gBACA,oBACA,UACA,cACA,YACA,gBACA,OACA,UACA,gBACA,kBACA,oBACA,gBACA,aACA,kBACA,cACA,cACA,iBACA,aACA,cACA,YACA,mBACA,UACA,oBACA,WACA,aACA,iBACA,aACA,WACA,aACA,WACA,SACA,QACA,cACA,cACA,cACA,cACA,oBACA,oBACA,eACA,eACA,gBACA,gBACA,cACA,aACA,kBACA,kBACA,aACA,kBACA,iBACA,YACA,UACA,cACA,kBACA,WACA,UACA,OACA,gBACA,aACA,QACA,SACA,aACA,UACA,YACA,6iBCxHF,IAuGMC,EAAQC,IAAOC,IAAVC,KAGLC,EAAOH,IAAOI,KAAVC,KAIJC,EAAUN,IAAOC,IAAVM,KAKPC,EAAWR,IAAOS,SAAVC,KAOCV,cArGE,SAAAW,GAAS,IAAAC,EACIC,mBAC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","file":"static/js/main.561cbaaa.chunk.js","sourcesContent":["import * as tonal from \"tonal\";\nimport { repeat } from \"ramda\";\n\nexport const parseSong = ({ chords, octave, loop }) => {\n  const loopedChords = repeat(chords, loop).join(\"|\");\n  const measures = loopedChords.split(\"|\");\n  const parsedChords = parseChords(measures);\n  const song = appendProgressionDetails(parsedChords, octave);\n  return song;\n};\n\nconst parseChords = measures => {\n  return measures\n    .map(measure => measure.split(\" \"))\n    .map(measure => measure.filter(chord => chord.length > 0));\n};\n\nconst spreadOctave = index => (index % 2 === 0 ? 1 : 0);\n\nconst appendProgressionDetails = (chords, octave) => {\n  return chords.map(measure =>\n    measure.map(chord => ({\n      notes: tonal.Chord.notes(chord).map(\n        (note, index) => `${note}${octave + spreadOctave(index)}`\n      ),\n      octave,\n      chord,\n      duration: measure.length > 1 ? `2` : `1`\n    }))\n  );\n};\n","import { slice, concat, reverse } from \"ramda\";\n\nimport MidiWriter from \"midi-writer-js\";\n\nexport const composeMidiFile = (chords, tempo, bassLine = false) => {\n    const track = new MidiWriter.Track();\n    const bassTrack = new MidiWriter.Track();\n\n    const chordEvents = chords.map(chord =>\n        // half length chord\n        chord.duration === \"2\" ?\n        new MidiWriter.NoteEvent({\n            pitch: slice(1, Infinity, chord.notes),\n            duration: \"2\"\n        }) : // full length chord\n        new MidiWriter.NoteEvent({\n            pitch: slice(1, Infinity, chord.notes),\n            duration: \"1\"\n        })\n    );\n    chordEvents.map(event => track.addEvent(event));\n\n    bassLine &&\n        chords.forEach(chord => {\n            generateBassLine(chord, bassTrack);\n        });\n\n    track.setTempo(tempo || 120);\n    const write = new MidiWriter.Writer([track, bassTrack]);\n    return write.dataUri();\n};\n\nconst getRandomNote = notes => {\n    //root note most probable\n    const weightedNotes = distributeNoteProbability(reverse(notes));\n    // then 3rd\n    const w2 = distributeNoteProbability(weightedNotes);\n    // then 5th\n    const w3 = distributeNoteProbability(w2);\n    return w3[Math.floor(Math.random() * w3.length)];\n};\n\nconst distributeNoteProbability = notes =>\n    concat(notes, slice(1, Infinity, notes));\n\nconst addRandomNoteToTrack = (chord, track, length) => {\n    track.addEvent(\n        new MidiWriter.NoteEvent({\n            pitch: `${getRandomNote(chord.notes).charAt(0)}2`,\n            duration: length\n        })\n    );\n};\n\nconst generateBassLine = (chord, track) => {\n    return chord.duration === \"2\" ?\n        new Array(2).fill().map(() => addRandomNoteToTrack(chord, track, \"4\")) :\n        new Array(4).fill().map(() => addRandomNoteToTrack(chord, track, \"4\"));\n};","import MidiPlayer from \"midi-player-js\";\n\nconst Soundfont = require(\"soundfont-player\");\n// https://github.com/gleitz/midi-js-soundfonts\nexport const playMidi = async(dataUri, instrument) => {\n    try {\n        const ac = new AudioContext();\n\n        Soundfont.instrument(\n            ac,\n            `https://raw.githubusercontent.com/gleitz/midi-js-soundfonts/gh-pages/FatBoy/${instrument}-mp3.js`\n        ).then(instrument => {\n            const Player = new MidiPlayer.Player(event => {\n                const time = ac.currentTime;\n                console.log(event);\n                event.name === \"Note on\" ?\n                    instrument.play(event.noteName, time, { gain: 0.8 }) :\n                    console.log(event);\n            });\n            Player.loadDataUri(dataUri);\n            Player.play();\n        });\n    } catch (error) {\n        alert(\"Browser does not support Audio Context, try Chrome\")\n    }\n};\n\nexport const playMidiThroughOutput = async(dataUri, output) => {\n    try {\n        const ac = new AudioContext();\n\n        const Player = new MidiPlayer.Player(event => {\n            console.log(output);\n            const time = ac.currentTime;\n            console.log(event);\n            event.name === \"Note on\" && output ?\n                output.playNote(event.noteName, \"all\", { time }) &&\n                output.stopNote(event.noteName, \"all\", { time: \"+500\" }) :\n                console.log(event);\n        });\n        Player.loadDataUri(dataUri);\n        Player.play();\n    } catch (error) {\n        alert(\"Browser does not support Audio Context, try Chrome\")\n    }\n};","export const soundFonts = [\n  \"accordion\",\n  \"acoustic_bass\",\n  \"acoustic_grand_piano\",\n  \"acoustic_guitar_nylon\",\n  \"acoustic_guitar_steel\",\n  \"agogo\",\n  \"alto_sax\",\n  \"applause\",\n  \"bagpipe\",\n  \"banjo\",\n  \"baritone_sax\",\n  \"bassoon\",\n  \"bird_tweet\",\n  \"blown_bottle\",\n  \"brass_section\",\n  \"breath_noise\",\n  \"bright_acoustic_piano\",\n  \"celesta\",\n  \"cello\",\n  \"choir_aahs\",\n  \"church_organ\",\n  \"clarinet\",\n  \"clavinet\",\n  \"contrabass\",\n  \"distortion_guitar\",\n  \"drawbar_organ\",\n  \"dulcimer\",\n  \"electric_bass_finger\",\n  \"electric_bass_pick\",\n  \"electric_grand_piano\",\n  \"electric_guitar_clean\",\n  \"electric_guitar_jazz\",\n  \"electric_guitar_muted\",\n  \"electric_piano_1\",\n  \"electric_piano_2\",\n  \"english_horn\",\n  \"fiddle\",\n  \"flute\",\n  \"french_horn\",\n  \"fretless_bass\",\n  \"fx_1_rain\",\n  \"fx_2_soundtrack\",\n  \"fx_3_crystal\",\n  \"fx_4_atmosphere\",\n  \"fx_5_brightness\",\n  \"fx_6_goblins\",\n  \"fx_7_echoes\",\n  \"fx_8_scifi\",\n  \"glockenspiel\",\n  \"guitar_fret_noise\",\n  \"guitar_harmonics\",\n  \"gunshot\",\n  \"harmonica\",\n  \"harpsichord\",\n  \"helicopter\",\n  \"honkytonk_piano\",\n  \"kalimba\",\n  \"koto\",\n  \"lead_1_square\",\n  \"lead_2_sawtooth\",\n  \"lead_3_calliope\",\n  \"lead_4_chiff\",\n  \"lead_5_charang\",\n  \"lead_6_voice\",\n  \"lead_7_fifths\",\n  \"lead_8_bass__lead\",\n  \"marimba\",\n  \"melodic_tom\",\n  \"music_box\",\n  \"muted_trumpet\",\n  \"oboe\",\n  \"ocarina\",\n  \"orchestra_hit\",\n  \"orchestral_harp\",\n  \"overdriven_guitar\",\n  \"pad_1_new_age\",\n  \"pad_2_warm\",\n  \"pad_3_polysynth\",\n  \"pad_4_choir\",\n  \"pad_5_bowed\",\n  \"pad_6_metallic\",\n  \"pad_7_halo\",\n  \"pad_8_sweep\",\n  \"pan_flute\",\n  \"percussive_organ\",\n  \"piccolo\",\n  \"pizzicato_strings\",\n  \"recorder\",\n  \"reed_organ\",\n  \"reverse_cymbal\",\n  \"rock_organ\",\n  \"seashore\",\n  \"shakuhachi\",\n  \"shamisen\",\n  \"shanai\",\n  \"sitar\",\n  \"slap_bass_1\",\n  \"slap_bass_2\",\n  \"soprano_sax\",\n  \"steel_drums\",\n  \"string_ensemble_1\",\n  \"string_ensemble_2\",\n  \"synth_bass_1\",\n  \"synth_bass_2\",\n  \"synth_brass_1\",\n  \"synth_brass_2\",\n  \"synth_choir\",\n  \"synth_drum\",\n  \"synth_strings_1\",\n  \"synth_strings_2\",\n  \"taiko_drum\",\n  \"tango_accordion\",\n  \"telephone_ring\",\n  \"tenor_sax\",\n  \"timpani\",\n  \"tinkle_bell\",\n  \"tremolo_strings\",\n  \"trombone\",\n  \"trumpet\",\n  \"tuba\",\n  \"tubular_bells\",\n  \"vibraphone\",\n  \"viola\",\n  \"violin\",\n  \"voice_oohs\",\n  \"whistle\",\n  \"woodblock\",\n  \"xylophone\"\n];\n","import React, { useState } from \"react\";\nimport { parseSong } from \"../util/songParser\";\nimport { composeMidiFile } from \"../util/composeMidiFile\";\nimport { flatten } from \"ramda\";\nimport { playMidi } from \"../util/playMidi\";\nimport styled from \"styled-components\";\nimport { soundFonts } from \"../samples/SoundFonts\";\n\nconst handleSubmit = ({\n  e,\n  allChords,\n  tempo,\n  instrument,\n  loop,\n  bass,\n  setFile\n}) => {\n  e.preventDefault();\n  try {\n    const chords = flatten(parseSong({ chords: allChords, octave: 4, loop }));\n    console.log(chords, \":::CHORDS\");\n    const midiDataUri = composeMidiFile(chords, tempo, bass);\n    setFile(midiDataUri);\n    playMidi(midiDataUri, instrument);\n  } catch (e) {\n    alert(\"unable to parse song\");\n  }\n};\n\nconst Fakebook = props => {\n  const [chords, setChords] = useState(\n    \"BMaj7 D7 | GMaj7 Bb7 | EbMaj7 | Am7 D7 | GMaj7 Bb7 | EbMaj7 F#7 | BMaj7| Fm7 Bb7 | EbMaj7 | Am7 D7 | GMaj7 | C#m7 F#7 | BMaj7 | Fm7 Bb7| EbMaj7 | C#m7 F#7\"\n  );\n  const [tempo, setTempo] = useState(240);\n  const [loop, setLoop] = useState(1);\n  const [bass, setBass] = useState(false);\n  const [file, setFile] = useState();\n\n  const [instrument, setInstrument] = useState(\"electric_grand_piano\");\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: '100vh',\n        alignItems: \"center\",\n        paddingTop: 90\n      }}\n    >\n      <form\n        onSubmit={e =>\n          handleSubmit({\n            e,\n            allChords: chords,\n            tempo,\n            instrument,\n            loop,\n            bass,\n            setFile\n          })\n        }\n      >\n        <JazzText value={chords} onChange={e => setChords(e.target.value)} />\n        <Options>\n          <Text>Tempo:</Text>\n          <input\n            value={tempo}\n            type=\"number\"\n            onChange={e => {\n              setTempo(e.target.value);\n            }}\n          />\n          <Space />\n\n          <Text>Repeat:</Text>\n          <input\n            value={loop}\n            type=\"number\"\n            onChange={e => {\n              setLoop(e.target.value);\n            }}\n          />\n          <Space />\n\n          <Text>Instrument:</Text>\n\n          <select\n            value={instrument}\n            onChange={e => setInstrument(e.target.value)}\n          >\n            {soundFonts.map(font => (\n              <option>{font}</option>\n            ))}\n          </select>\n          <Space />\n          <Text>Bassline:</Text>\n          <select value={bass} onChange={e => setBass(e.target.value)}>\n            <option value={true}>{\"true\"}</option>\n            <option value={false}>{\"false\"}</option>\n          </select>\n          <Space />\n          <input type=\"submit\" value=\"Play\" />\n          <Space />\n          <Space />\n          <a href={file}>Download MIDI</a>\n        </Options>\n      </form>\n    </div>\n  );\n};\n\nconst Space = styled.div`\n  padding: 20;\n`;\nconst Text = styled.text`\n  font-size: 12pt;\n`;\n\nconst Options = styled.div`\n  justify-content: space-between;\n  flex-direction: column;\n  height: 100px;\n`;\nconst JazzText = styled.textarea`\n  font-size: 24pt;\n  max-width: 800px;\n  width: 100%;\n  height: 400px;\n`;\n\nexport default styled(Fakebook)``;\n","import React from \"react\";\nimport Tone from \"tone\";\nvar tremolo = new Tone.Tremolo().start();\n\nexport const withSynth = Cmp => props => {\n  const synth = new Tone.PolySynth({\n    oscillator: {\n      type: \"fmsquare\",\n      modulationType: \"sawtooth\",\n      modulationIndex: 3,\n      harmonicity: 3.4\n    },\n\n    envelope: {\n      attack: 0.001,\n      decay: 0.1,\n      sustain: 0.1,\n      release: 0.1\n    }\n  }).chain(tremolo, Tone.Master);\n\n  const fmSynth = new Tone.FMSynth().toMaster();\n\n  return (\n    <Cmp synth={synth} fmSynth={fmSynth} {...props}>\n      {props.children}\n    </Cmp>\n  );\n};\n","import React, { useRef, useState, useEffect } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { withSynth } from \"../util/withSynth\";\nimport { length } from \"ramda\";\n\nconst noteFromRotation = (rotation, notes) => {\n  const index = Math.ceil(rotation * 5) % length(notes);\n  console.log(notes[index]);\n  return notes[index];\n};\n\nexport const Box = props => {\n  // This reference will give us direct access to the mesh\n  const mesh = useRef();\n\n  // Set up state for the hovered and active state\n  const [hovered, setHover] = useState(false);\n  const [active, setActive] = useState(false);\n  const [activeNote, setActiveNote] = useState();\n  const [cutoffValue, setCutoffValue] = useState(1);\n\n  props.midiIn &&\n    !activeNote &&\n    props.midiIn.addListener(\"noteon\", \"all\", e => {\n      console.log(\n        \"Received 'noteon' message (\" + e.note.name + e.note.octave + \").\"\n      );\n      const note = e.note.name + e.note.octave;\n      setActiveNote(note);\n    });\n\n  props.midiIn &&\n    !activeNote &&\n    props.midiIn.addListener(\"controlchange\", \"all\", e => {\n      console.log(e);\n      setCutoffValue(e.value);\n    });\n\n  useEffect(() => {\n    props.synth &&\n      props.synth.set({\n        detune: cutoffValue * 10\n      });\n  }, [cutoffValue]);\n\n  props.midiIn && props.midiIn.removeListener(\"noteoff\");\n\n  useFrame(() => {\n    mesh.current.rotation.x = mesh.current.rotation.y += 0.01;\n    mesh.current.rotation.y =\n      activeNote && activeNote.includes(props.activationNotes[0])\n        ? (mesh.current.rotation.y += 1)\n        : mesh.current.rotation.y;\n\n    mesh.current.position.z =\n      activeNote && activeNote.includes(props.activationNotes[1])\n        ? (mesh.current.position.z += 0.01)\n        : mesh.current.position.z;\n\n    mesh.current.position.z =\n      activeNote && activeNote.includes(props.activationNotes[2])\n        ? (mesh.current.position.z -= 0.01)\n        : mesh.current.position.z;\n\n    mesh.current.position.y =\n      activeNote && activeNote.includes(props.activationNotes[3])\n        ? (mesh.current.position.y -= 0.01)\n        : mesh.current.position.y;\n\n    mesh.current.position.y =\n      activeNote && activeNote.includes(props.activationNotes[4])\n        ? (mesh.current.position.y += 0.01)\n        : mesh.current.position.y;\n\n    mesh.current.position.x =\n      activeNote && activeNote.includes(props.activationNotes[5])\n        ? (mesh.current.position.x -= 0.01)\n        : mesh.current.position.x;\n\n    mesh.current.position.x =\n      activeNote && activeNote.includes(props.activationNotes[6])\n        ? (mesh.current.position.x += 0.01)\n        : mesh.current.position.x;\n\n    if (mesh.current.position.x >= 4 || mesh.current.position.x <= -4) {\n      mesh.current.position.x = 0;\n    }\n    if (mesh.current.position.y >= 4 || mesh.current.position.y <= -4) {\n      mesh.current.position.y = 0;\n    }\n    if (mesh.current.position.z >= 4 || mesh.current.position.z <= -4) {\n      mesh.current.position.z = 0;\n    }\n  });\n  const rotationY = mesh.current ? mesh.current.rotation.y / 3 : 1;\n  return (\n    <mesh\n      {...props}\n      ref={mesh}\n      scale={!active ? [(0.5 * cutoffValue) / 10, 0.5, 0.5] : [0.7, 0.7, 0.7]}\n      onClick={e => {\n        setActive(!active);\n        console.log(mesh.current.rotation.y);\n        const note = noteFromRotation(rotationY, props.notes);\n        props.synth && props.synth.triggerAttackRelease(note, 0.5);\n        props.midiOut &&\n          props.midiOut.playNote(note, \"all\", { duration: 1000 });\n      }}\n      onPointerOver={e => setHover(true)}\n      onPointerOut={e => setHover(false)}\n    >\n      <boxBufferGeometry attach=\"geometry\" args={[1, 1, 1]} />\n      <meshStandardMaterial\n        attach=\"material\"\n        color={hovered ? \"#FFFF00\" : \"#00ffff\"}\n      />\n    </mesh>\n  );\n};\n\nexport const SynthBox = withSynth(Box);\n","import React from \"react\";\nimport { Canvas } from \"react-three-fiber\";\n\nexport const ThreeDCanvas = props => {\n  return (\n    <Canvas\n      style={{\n        width: \"100vw\",\n        height: '800px',\n      }}\n    >\n      <ambientLight />\n      <pointLight position={[10, 10, 10]} />\n      {props.children}\n    </Canvas>\n  );\n};\n\nexport const SmallCanvas = props => {\n  return (\n    <Canvas style={{ width: 290, height: 150 }}>\n      <ambientLight />\n      <pointLight position={[10, 10, 10]} />\n      {props.children}\n    </Canvas>\n  );\n};\n","import React from \"react\";\nimport { SynthBox } from \"./Box\";\nimport { ThreeDCanvas } from \"./ThreeDCanvas\";\nimport { reverse } from \"ramda\";\nexport const MidiIn = props => {\n  return (\n    <div style={{\n      display: 'flex',\n      flexDirection: 'column',\n      width: \"100%\",\n      paddingTop: 90,\n      alignItems: \"center\"\n    }}>\n      {props.midiIns && props.midiIns.length === 0 && <p>Please plugin a midi controller</p>}\n\n      <div style={{ justifyContent: \"space-between\" }}>\n        <select>\n          {props.midiIns &&\n            props.midiIns.map(input => (\n              <option\n                value={input._midiInput.id}\n                onChange={() => props.setMidiInId(input._midiInput.id)}\n              >\n                {input._midiInput.name}\n              </option>\n            ))}\n        </select>\n      </div>\n      <ThreeDCanvas>\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-3, -0.5, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[1, 0, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"])}\n          notes={reverse([\n            \"A4\",\n            \"C5\",\n            \"D3\",\n            \"E4\",\n            \"G4\",\n            \"A3\",\n            \"C4\",\n            \"D5\",\n            \"E4\",\n            \"G4\"\n          ])}\n          position={[-2, 3, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"Bb\", \"Ab\", \"D\", \"F\", \"E\", \"F\", \"G\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-3, 2, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"Bb\", \"Ab\", \"D\", \"F\", \"E\", \"F\", \"G\"])}\n          notes={reverse([\n            \"A4\",\n            \"C5\",\n            \"D3\",\n            \"E4\",\n            \"G4\",\n            \"A3\",\n            \"C4\",\n            \"D5\",\n            \"E4\",\n            \"G4\"\n          ])}\n          position={[-1, 1, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"E\", \"Gb\", \"C\", \"D\", \"B\", \"Bb\", \"Eb\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[1, -1, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"E\", \"Gb\", \"C\", \"D\", \"B\", \"Bb\", \"Eb\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[1, -1, 0]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"Eb\", \"Gb\", \"C\", \"A\", \"C\", \"D\", \"B\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-2, -1, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"Eb\", \"Gb\", \"C\", \"A\", \"C\", \"D\", \"B\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-2, -1, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"D\", \"E\", \"C\", \"G\", \"Eb\", \"Gb\", \"C\"]}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-3, -1, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"D\", \"E\", \"C\", \"G\", \"Eb\", \"Gb\", \"C\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-4, 3, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={[\"D\", \"C\", \"E\", \"Gb\", \"C\", \"G\", \"Eb\"]}\n          notes={reverse([\n            \"A4\",\n            \"C5\",\n            \"D3\",\n            \"E4\",\n            \"G4\",\n            \"A3\",\n            \"C4\",\n            \"D5\",\n            \"E4\",\n            \"G4\"\n          ])}\n          position={[-4, 3, 1]}\n        />\n        <SynthBox\n          midiIn={props.midiIn}\n          noteEvent={props.noteEvent}\n          activationNotes={reverse([\"D\", \"E\", \"C\", \"G\", \"Eb\", \"Gb\", \"C\"])}\n          notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n          position={[-4, 3, 1]}\n        />\n      </ThreeDCanvas>\n    </div>\n  );\n};\n","import React, { useState } from \"react\";\nimport { parseSong } from \"../util/songParser\";\nimport { composeMidiFile } from \"../util/composeMidiFile\";\nimport { flatten } from \"ramda\";\nimport { playMidiThroughOutput } from \"../util/playMidi\";\nimport styled from \"styled-components\";\nimport { Box } from \"./Box\";\nimport { ThreeDCanvas } from \"./ThreeDCanvas\";\n\nconst handleSubmit = ({ e, allChords, output, tempo, loop, bass }) => {\n  try {\n    e.preventDefault();\n    const chords = flatten(parseSong({ chords: allChords, octave: 4, loop }));\n    const midiDataUri = composeMidiFile(chords, tempo, bass);\n    playMidiThroughOutput(midiDataUri, output);\n  } catch {\n    alert(\"unable to parse song\");\n  }\n};\n\nconst MidiOut = props => {\n  const [chords, setChords] = useState(\"A | B | C | D\");\n  const [tempo, setTempo] = useState(160);\n  const [loop, setLoop] = useState(1);\n  const [bass, setBass] = useState(false);\n\n  const [noteBoxes, ] = useState([\n    [\"A4\", \"C4\", \"D4\", \"E4\", \"G4\"],\n    [\"G4\", \"A4\", \"B4\", \"Db4\", \"Eb4\", \"F4\"],\n    [\"A5\", \"Db5\", \"Eb5\", \"E5\", \"G2\"],\n    [\"G4\", \"A4\", \"B4\", \"Db4\", \"Eb4\", \"F4\"],\n    [\"A5\", \"Db5\", \"Eb5\", \"E5\", \"G2\"]\n  ]);\n\n  return (\n      <div\n        style={{\n        display: 'flex',\n        flexDirection: 'column',\n        width: \"100%\",\n        paddingTop: 90,\n        alignItems: \"center\"\n        }}\n    >\n      {props.midiOuts && props.midiOuts.length === 0 && <p>Please plugin a midi output</p>}\n        <select>\n          {props.midiOuts &&\n            props.midiOuts.map(output => (\n              <option\n                value={output._midiOutput.id}\n                onChange={() => props.setMidiOutId(output._midiInput.id)}\n              >\n                {output._midiOutput.name}\n              </option>\n            ))}\n        </select>\n        <form\n          onSubmit={e =>\n            handleSubmit({\n              e,\n              allChords: chords,\n              output: props.midiOut,\n              loop,\n              tempo,\n              bass\n            })\n          }\n        >\n          <MidiText value={chords} onChange={e => setChords(e.target.value)} />\n          <input type=\"submit\" value=\"Play\" />\n        </form>\n        <Options>\n          <Text>Tempo:</Text>\n          <input\n            value={tempo}\n            type=\"number\"\n            onChange={e => {\n              setTempo(e.target.value);\n            }}\n          />\n          <Space />\n\n          <Text>Repeat:</Text>\n          <input\n            value={loop}\n            type=\"number\"\n            onChange={e => {\n              setLoop(e.target.value);\n            }}\n          />\n\n          <Space />\n          <Text>Bassline:</Text>\n          <select value={bass} onChange={e => setBass(e.target.value)}>\n            <option value={true}>{\"true\"}</option>\n            <option value={false}>{\"false\"}</option>\n          </select>\n        </Options>\n        <ThreeDCanvas style={{ width: \"100%\", height: 400}}>\n          {noteBoxes.map((notes, i) =>\n            i % 2 !== 0 ? (\n              <Box\n                key={i}\n                midiOut={props.midiOut}\n                notes={notes}\n                position={[-i, 0.5, 0]}\n              />\n            ) : (\n              <Box\n                key={i}\n                midiOut={props.midiOut}\n                notes={notes}\n                position={[i - 4, 2, 0]}\n              />\n            )\n          )}\n        </ThreeDCanvas>\n      </div>\n  );\n};\n\nconst MidiText = styled.textarea`\n  font-size: 16pt;\n  font-family: Arial;\n`;\n\nconst Space = styled.div`\n  padding: 20;\n`;\nconst Text = styled.text`\n  font-size: 12pt;\n`;\n\nconst Options = styled.div`\n  justify-content: space-between;\n  flex-direction: column;\n  height: 100px;\n`;\n\nexport default MidiOut;\n","import React from \"react\";\nimport { SynthBox } from \"./Box\";\nimport { SmallCanvas } from \"./ThreeDCanvas\";\nimport styled from \"styled-components\";\n\nexport const Code = props => {\n  const rawWebMidiAPICodeBlock = `\nnavigator.requestMIDIAccess()\n  .then(onMIDISuccess);\n\nconst onMIDISuccess = (webMidiAPI) => {\n    console.log(webMidiAPI.inputs, webMidiAPI.outputs);\n    const inputs = webMidiAPI.inputs\n    inputs.map(input => {\n        input.value.onmidimessage = onMIDIMessage;\n    })\n}\n\nconst noteOn = (midiNote, velocity) => {\n    // Use a Web Audio API or library \n    // to play the note\n    // or update your UI\n    play(midiNote, velocity)\n}\n\nconst onMIDIMessage = (event) => {\n    const data = event.data,\n    const [type, note, velocity] = data,\n\n    type === 144 && noteOn(note, velocity);\n    type === 128 && noteOff(note, velocity);\n}\n\n// This project does not use the Web MIDI API directly. \n// Instead I use a bunch of libraries. This is JS afterall.\n`;\n\n  const webMidiJsCodeBlock = `\nimport WebMidi from \"webmidi\";\n\nWebMidi.enable(() => {\n\n    // Easily get inputs and outputs\n    console.log(WebMidi.inputs);\n    console.log(WebMidi.outputs);\n\n    const input = WebMidi.getInputById(\n        WebMidi.inputs[0]._midiInput.id\n    );\n\n    const output = WebMidi.getOutputById(\n        WebMidi.outputs[0]._midiOutput.id\n    );\n\n    // much easier to implement a noteon\n    input.addListener(\"noteon\", \"all\", e => {\n\n        const note = e.note.name + e.note.octave;\n\n        // Play with instrument or use the note \n        // to control a display\n        synth.triggerAttackRelease(note, 0.5);\n    });\n});\n    `;\n\n  const writingMidiFileCodeBlock = `\n  import MidiWriter from \"midi-writer-js\";\n\n  const track = new MidiWriter.Track();\n\n  // Add a BbMaj9 chord\n  new MidiWriter.NoteEvent({\n    pitch: ['Bb4', 'D5', 'A5', 'C5'],\n    duration: \"1\"\n  })\n\n  // Add as many tracks as you want\n  const midiFile = new MidiWriter.Writer([track]);\n\n  // You can use the data uri with other libraries\n  // to play back MIDI and perform any code in time with\n  // the MIDI.\n  // Or you can directly download it and play the file in your \n  // favoroite software.\n\n  midiFile.dataUri();\n  `;\n\n  const midiOutputCodeBlock = `\nimport MidiPlayer from \"midi-player-js\";\n\nconst ac = new AudioContext();\n\n  // output from previous code block\n  // this output is your synthesizer\n  // data uri from midi writer\n\n  export const playMidi = async (dataUri, output) => {\n\n    const Player = new MidiPlayer.Player(event => {\n\n      // AudioContext is important for scheduling\n      const time = ac.currentTime;\n\n      // This can be any MIDI event\n      // This is the block in which the music is played\n      event.name === \"Note on\" && output && \n            output.playNote(event.noteName, \"all\", { time })\n    });\n\n    Player.loadDataUri(dataUri);\n    Player.play();\n  };\n`;\n\n  const citations = `\nCitations and Further reading:\nhttps://webaudio.github.io/web-midi-api/\nhttps://www.keithmcmillen.com/blog/making-music-in-the-browser-web-midi-api/\nhttps://github.com/djipco/webmidi\nhttps://www.smashingmagazine.com/2018/03/web-midi-api/\nhttps://developer.mozilla.org/en-US/docs/Web/API/BaseAudioContext/currentTime\n\nOther libraries used\nReact.js\nstyled-components \nTonal (music theory) https://github.com/tonaljs/tonal\nreact-three-fiber (threejs for react) https://github.com/react-spring/react-three-fiber\nTone.js (synthesizers) https://tonejs.github.io/\n`;\n\n  return (\n    <div style={{ paddingTop: 90 }}>\n      <div style={{\n        // display: 'flex',\n        // justifyContent: \"center\",\n        // alignItems: 'center',\n        // padding: 20,\n        // flexDirection: 'column',\n      }}>\n\n        <CodeTitle>Web Midi API</CodeTitle>\n        <CodeSnippet>\n          {rawWebMidiAPICodeBlock}\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[0, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <CodeTitle>webmidi.js</CodeTitle>\n        <CodeSnippet>\n          {webMidiJsCodeBlock}\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[0, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <CodeTitle>midiwriter.js</CodeTitle>\n        <CodeSnippet>\n          {writingMidiFileCodeBlock}\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[0, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <CodeTitle>midiplayer.js</CodeTitle>\n        <CodeSnippet>\n          {midiOutputCodeBlock}\n        </CodeSnippet>\n        <SmallCanvas>\n          <SynthBox\n            noteEvent={props.noteEvent}\n            activationNotes={[\"C\", \"D\", \"F\", \"G\", \"B\", \"E\", \"F\"]}\n            notes={[\"A4\", \"C5\", \"D3\", \"E4\", \"G4\", \"A3\", \"C4\", \"D5\", \"E4\", \"G4\"]}\n            position={[0, -0.5, 3]}\n          />\n        </SmallCanvas>\n        <CodeSnippet>\n          {citations}\n          </CodeSnippet>\n        </div>\n      </div>\n  );\n};\n\nconst CodeSnippet = styled.p`\n  background-color: #000000;\n  border-radius: 10px;\n  text-align: left;\n  padding-left: 20px;\n  padding-right: 20px;\n  padding-bottom: 20px;\n  margin-top: 20px;\n  white-space: pre;\n  font-size: 16px;\n  word-wrap: break-word;\n`;\n\n\nconst CodeTitle = styled.p`\n  color: #ffffff;\n  font-size: 24pt;\n  text-align: left;\n  user-select: none;\n`;\n","import React, { useState, useEffect } from \"react\";\nimport WebMidi from \"webmidi\";\nimport { withSynth } from \"./withSynth\";\nimport { compose, length } from \"ramda\";\n\nexport const withWebMidi = Cmp => props => {\n  const [noteEvent, ] = useState();\n  const [midiOutId, setMidiOutId] = useState();\n  const [midiOut, setMidiOut] = useState();\n  const [midiIn, setMidiIn] = useState();\n  const [midiInId, setMidiInId] = useState();\n  const [midiOuts, setMidiOuts] = useState();\n  const [midiIns, setMidiIns] = useState();\n\n  useEffect(() => {\n    WebMidi.enable(() => {\n      console.log(WebMidi.inputs);\n      console.log(WebMidi.outputs);\n      setMidiIns(WebMidi.inputs);\n      setMidiOuts(WebMidi.outputs);\n      if (length(WebMidi.inputs) > 0 && length(WebMidi.outputs) > 0) {\n        const input = WebMidi.getInputById(\n          midiInId || WebMidi.inputs[1]._midiInput.id\n        );\n        // const output = WebMidi.getOutputById(\"1295864820\");\n        const output = WebMidi.getOutputById(\n          midiOutId || WebMidi.outputs[1]._midiOutput.id\n        );\n\n        setMidiOut(output);\n        setMidiIn(input);\n        // input.addListener(\"noteon\", \"all\", e => {\n        //   console.log(\n        //     \"Received 'noteon' message (\" + e.note.name + e.note.octave + \").\"\n        //   );\n        //   const note = e.note.name + e.note.octave;\n        //   setNoteEvent(note);\n        //   props.synth.triggerAttackRelease(note, 0.5);\n        // });\n        // input.removeListener(\"noteoff\");\n      }\n    });\n  }, [midiOutId, midiInId, midiIns, midiOuts]);\n\n  return (\n    <Cmp\n      noteEvent={noteEvent}\n      midiOuts={midiOuts}\n      setMidiOutId={setMidiOutId}\n      midiIns={midiIns}\n      setMidiInId={setMidiInId}\n      midiOut={midiOut}\n      midiIn={midiIn}\n      {...props}\n    >\n      {props.children}\n    </Cmp>\n  );\n};\n\nexport const withMidi = compose(withSynth, withWebMidi);\n","import React from \"react\";\n\nimport { HashRouter as Router, Switch, Route, Link } from \"react-router-dom\";\nimport Fakebook from \"./components/Fakebook\";\nimport { MidiIn } from \"./components/MidiIn\";\nimport MidiOut from \"./components/MidiOut\";\nimport { Code } from \"./components/Code\";\nimport { withMidi } from \"./util/withMidi\";\nimport styled from \"styled-components\";\n\nexport const Routes = props => {\n  return (\n    <Router basename={\"/\"}>\n      <div style={{ flexDirection: \"row\" }}>\n        <SideNav>\n          <NavItem>\n            <Link to=\"/fakebook\">Jazzbot</Link>\n          </NavItem>\n          <NavItem>\n            <Link to=\"/midi-in\">midi-in</Link>\n          </NavItem>\n          <NavItem>\n            <Link to=\"/midi-out\">midi-out</Link>\n          </NavItem>\n          <NavItem>\n            <Link to=\"/code\">code</Link>\n          </NavItem>\n        </SideNav>\n        <Switch>\n          <Route path=\"/fakebook\">\n            <Fakebook />\n          </Route>\n          <Route path=\"/midi-in\">\n            <MidiIn {...props} />\n          </Route>\n          <Route path=\"/midi-out\">\n            <MidiOut {...props} />\n          </Route>\n          <Route path=\"/code\">\n            <Code {...props} />\n          </Route>\n          <Route path=\"/\" component={Fakebook}></Route>\n        </Switch>\n      </div>\n    </Router>\n  );\n};\n\n\nconst NavItem = styled.div`\n  padding-left: 20px;\n  color: #ffffff;\n`;\n\nconst SideNav = styled.div`\n  position: fixed;\n  display: flex;\n  left: 0;\n  height: 50px;\n  width: 100vw;\n  z-index: 20;\n  background-color: #000000;\n  justify-content: left;\n  align-items: center;\n  flex-direction: row;\n  padding-bottom: 10px;\n  top: 0;\n  border-bottom: solid;\n  border-bottom-width: 1px;\n  border-bottom-color: #ffffff\n`;\n\nexport default withMidi(Routes);\n","import React from \"react\";\nimport \"./App.css\";\nimport Routes from \"./Routes\";\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n        <Routes />\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}